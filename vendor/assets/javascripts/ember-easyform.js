// ==========================================================================
// Project:   Ember EasyForm
// Copyright: Â©2013 DockYar, LLC. and contributors.
// License:   Licensed under MIT license (see license.js)
// ==========================================================================


// Last commit: ce0709a (2013-05-16 17:09:31 +0100)


(function(){Ember.EasyForm=Ember.Namespace.create({VERSION:"0.3.1"})})(),function(){Ember.EasyForm.Config=Ember.Namespace.create({_wrappers:{"default":{formClass:"",fieldErrorClass:"fieldWithErrors",inputClass:"input",errorClass:"error",hintClass:"hint",labelClass:"",wrapControls:!1,controlsWrapperClass:""}},_inputTypes:{},registerWrapper:function(e,t){this._wrappers[e]=Ember.$.extend({},this._wrappers["default"],t)},getWrapper:function(e){var t=this._wrappers[e];return t},registerInputType:function(e,t){this._inputTypes[e]=t},getInputType:function(e){return this._inputTypes[e]}})}(),function(){Ember.Handlebars.registerHelper("errorField",function(e,t){if(this.get("errors"))return t.hash.property=e,Ember.Handlebars.helpers.view.call(this,Ember.EasyForm.Error,t)})}(),function(){Ember.Handlebars.registerBoundHelper("formFor",function(e,t){return Ember.Handlebars.helpers.view.call(e,Ember.EasyForm.Form,t)})}(),function(){Ember.Handlebars.registerHelper("hintField",function(e,t){if(t.hash.text)return Ember.Handlebars.helpers.view.call(this,Ember.EasyForm.Hint,t)})}(),function(){Ember.Handlebars.registerHelper("input",function(e,t){return t.hash.inputOptions=Ember.copy(t.hash),t.hash.property=e,t.hash.isBlock=!!t.fn,Ember.Handlebars.helpers.view.call(this,Ember.EasyForm.Input,t)})}(),function(){Ember.Handlebars.registerHelper("inputField",function(e,t){var n=this,r=function(e){try{return(n.get("content")||n).constructor.metaForProperty(e).type}catch(t){return null}};t.hash.valueBinding=e,t.hash.viewName="inputField-"+t.data.view.elementId;if(t.hash.inputConfig){var i=t.hash.inputConfig.split(";"),s=i.length;while(s--){var o=i[s].split(":");t.hash[o[0]]=o[1]}}if(t.hash.as==="text")return Ember.Handlebars.helpers.view.call(n,Ember.EasyForm.TextArea,t);if(t.hash.as==="select")return delete t.hash.valueBinding,t.hash.contentBinding=t.hash.collection,t.hash.selectionBinding=t.hash.selection,t.hash.valueBinding=t.hash.value,Ember.Handlebars.helpers.view.call(n,Ember.EasyForm.Select,t);if(!t.hash.as){if(e.match(/password/))t.hash.type="password";else if(e.match(/email/))t.hash.type="email";else if(e.match(/url/))t.hash.type="url";else if(e.match(/color/))t.hash.type="color";else if(e.match(/^tel/))t.hash.type="tel";else if(e.match(/search/))t.hash.type="search";else if(r(e)==="number"||typeof n.get(e)=="number")t.hash.type="number";else if(r(e)==="date"||!Ember.isNone(n.get(e))&&n.get(e).constructor===Date)t.hash.type="date";else if(r(e)==="boolean"||!Ember.isNone(n.get(e))&&n.get(e).constructor===Boolean)return t.hash.checkedBinding=e,Ember.Handlebars.helpers.view.call(n,Ember.EasyForm.Checkbox,t)}else{var u=Ember.EasyForm.Config.getInputType(t.hash.as);if(u)return t.hash.property=e,Ember.Handlebars.helpers.view.call(n,u,t);t.hash.type=t.hash.as}return Ember.Handlebars.helpers.view.call(n,Ember.EasyForm.TextField,t)})}(),function(){Ember.Handlebars.registerHelper("labelField",function(e,t){return t.hash.property=e,t.hash.viewName="labelField-"+t.data.view.elementId,Ember.Handlebars.helpers.view.call(this,Ember.EasyForm.Label,t)})}(),function(){Ember.Handlebars.registerHelper("submit",function(e,t){return typeof e=="object"&&(t=e,e=undefined),t.hash.context=this,t.hash.value=e||"Submit",Ember.Handlebars.helpers.view.call(this,Ember.EasyForm.Submit,t)})}(),function(){}(),function(){Ember.EasyForm.BaseView=Ember.View.extend({getWrapperConfig:function(e){var t=Ember.EasyForm.Config.getWrapper(this.get("wrapper"));return t[e]},wrapper:Ember.computed(function(){var e=this.get("parentView");while(e){var t=e.get("wrapper");if(t)return t;e=e.get("parentView")}return"default"})})}(),function(){Ember.EasyForm.Checkbox=Ember.Checkbox.extend()}(),function(){Ember.EasyForm.Error=Ember.EasyForm.BaseView.extend({tagName:"span",init:function(){var e;this._super(),this.classNames.push(this.getWrapperConfig("errorClass")),e={},e[""+this.property+"Watch"]=function(){return typeof this.get("controller.errors."+this.property)=="string"?this.get("controller.errors."+this.property):(this.get("controller.errors."+this.property)||[])[0]}.property("controller.errors."+this.property),this.reopen(e),this.set("template",Ember.Handlebars.compile("{{view."+this.property+"Watch}}"))}})}(),function(){Ember.EasyForm.Form=Ember.EasyForm.BaseView.extend({tagName:"form",attributeBindings:["novalidate"],novalidate:"novalidate",wrapper:"default",init:function(){this._super(),this.classNames.push(this.getWrapperConfig("formClass"))},submit:function(e){var t=this,n;e&&e.preventDefault(),Ember.isNone(this.get("context.validate"))?this.get("controller").send("submit"):(Ember.isNone(this.get("context").validate)?n=this.get("context.content").validate():n=this.get("context").validate(),n.then(function(){t.get("context.isValid")===!0&&t.get("controller").send("submit")}))}})}(),function(){Ember.EasyForm.Hint=Ember.EasyForm.BaseView.extend({tagName:"span",init:function(){this._super(),this.classNames.push(this.getWrapperConfig("hintClass")),this.set("template",Ember.Handlebars.compile(this.get("text")))}})}(),function(){Ember.EasyForm.Input=Ember.EasyForm.BaseView.extend({init:function(){this._super(),this.classNameBindings.push("error:"+this.getWrapperConfig("fieldErrorClass")),this.classNames.push(this.getWrapperConfig("inputClass")),this.isBlock||this.set("template",Ember.Handlebars.compile(this.fieldsForInput())),Ember.isNone(this.get("context.errors"))||this.reopen({error:function(){return this.get("context").get("errors").get(this.property)!==undefined}.property("context.errors."+this.property)})},tagName:"div",classNames:["string"],didInsertElement:function(){this.set("labelField-"+this.elementId+".for",this.get("inputField-"+this.elementId+".elementId"))},concatenatedProperties:["inputOptions"],inputOptions:["as","placeholder","inputConfig","collection","prompt","optionValuePath","optionLabelPath","selection","value"],fieldsForInput:function(){return this.labelField()+this.wrapControls(this.inputField()+this.errorField()+this.hintField())},labelField:function(){var e=this.label?'text="'+this.label+'"':"";return"{{labelField "+this.property+" "+e+"}}"},inputField:function(){var e="",t,n=this.inputOptions;for(var r=0;r<n.length;r++)t=n[r],this[t]&&(typeof this[t]=="boolean"&&(this[t]=t),e=e.concat(""+t+'="'+this[n[r]]+'"'));return e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),"{{inputField "+this.property+" "+e+"}}"},errorField:function(){var e="";return"{{#if errors."+this.property+"}}{{{errorField "+this.property+" "+e+"}}{{/if}}"},hintField:function(){var e=this.hint?'text="'+this.hint+'"':"";return"{{hintField "+this.property+" "+e+"}}"},wrapControls:function(e){return this.getWrapperConfig("wrapControls")?'<div class="'+this.getWrapperConfig("controlsWrapperClass")+'">'+e+"</div>":e},focusOut:function(){Ember.isNone(this.get("context.validate"))||(Ember.isNone(this.get("context").validate)?this.get("context.content").validate(this.property):this.get("context").validate(this.property))}})}(),function(){Ember.EasyForm.Label=Ember.EasyForm.BaseView.extend({tagName:"label",attributeBindings:["for"],init:function(){this._super(),this.classNames.push(this.getWrapperConfig("labelClass")),this.set("template",this.renderText())},renderText:function(){return Ember.Handlebars.compile(this.text||this.property.underscore().split("_").join(" ").capitalize())}})}(),function(){Ember.EasyForm.Select=Ember.Select.extend()}(),function(){Ember.EasyForm.Submit=Ember.View.extend({tagName:"input",attributeBindings:["type","value"],type:"submit",init:function(){this._super(),this.set("value",this.value)},onClick:function(){this.get("context").validate()&&this.get("controller").send("submit")}})}(),function(){Ember.EasyForm.TextArea=Ember.TextArea.extend()}(),function(){Ember.EasyForm.TextField=Ember.TextField.extend()}(),function(){}(),function(){Ember.TEMPLATES["easyForm/input"]=Ember.Handlebars.compile('<label {{bindAttr for="labelFor"}}>{{labelText}}</label>')}(),function(){}(),function(){Ember.EasyForm.objectNameFor=function(e){var t=e.constructor.toString().split(".");return t[t.length-1].underscore()}}(),function(){}(),typeof location!="undefined"&&(location.hostname==="localhost"||location.hostname==="127.0.0.1")&&console.warn("You are running a production build of Ember on localhost and won't receive detailed error messages. If you want full error messages please use the non-minified build provided on the Ember website.");